# Тестовое задание по компьютерному зрению: детекция и трекинг лиц

## Описание проекта

Данный проект реализует систему для оценки демографии посетителей торговых центров или ресторанов. Система использует детекцию и трекинг лиц на видеопотоке с веб-камеры для последующего определения возраста и пола каждого посетителя.

**Цель проекта:**

- Детектировать лица на видеопотоке.
- Трекать обнаруженные лица, чтобы не считать одного и того же посетителя несколько раз.
- Отображать миниатюры лиц в правой части экрана, когда есть детекция.

**Примечание:** В текущей версии проекта реализованы детекция и трекинг лиц, а также отображение миниатюр справа, когда есть детекция. Критерии оценки каждого лица и выбор "лучшего" лица за трек при разрыве трека не реализованы.

## Технологии и инструменты

- **Язык программирования:** Python 3.8
- **Библиотеки:**
  - ultralytics==8.2.41
  - omegaconf==2.3.0
  - flask==3.0.3
  - OpenCV

## Настройка окружения

### Для Linux

1. **Создайте и активируйте виртуальное окружение:**

   ```bash
   python3 -m venv venv
   source venv/bin/activate


Установите зависимости:
- make install

### Для Windows
Создайте и активируйте виртуальное окружение:
- python -m venv venv
- venv\Scripts\activate

Установите зависимости:
- make install

**Примечание**: Убедитесь, что у вас установлен инструмент make на Windows. 
Если make отсутствует, вы можете установить зависимости напрямую:
- pip install -r requirements.txt

## Команды

#### Подготовка
* `make install` - установка библиотек

#### Запуск
* `make run_app` - запустить детект видео
* для просмотра открыть в браузере http://127.0.0.1:5000/video_feed

#### Сборка образа
* `make build` - собрать образ. Можно с аргументами `DOCKER_TAG`, `DOCKER_IMAGE`

## Как работает приложение
### Детекция лиц:
- Каждый кадр видеопотока анализируется для обнаружения лиц с помощью Ultralytics YOLOv8.
### Трекинг лиц:
- Обнаруженные лица передаются в трекер, который присваивает уникальные идентификаторы и отслеживает их между кадрами.
### Отображение миниатюр:
- В правой части экрана отображаются миниатюры лиц, когда есть детекция.
- Когда детекции нет, миниатюры не отображаются.
- Примечание: Функционал выбора "лучшего" лица за трек при разрыве трека не реализован.

## Демонстрация работы детектора

[![Демонстрация работы](https://img.youtube.com/vi/SX_3p-AKz1o/0.jpg)](https://www.youtube.com/watch?v=SX_3p-AKz1o)

## Демонстрация работы сервиса

[![Демонстрация работы](https://img.youtube.com/vi/bsDTsUvho-A/0.jpg)](https://youtube.com/shorts/bsDTsUvho-A?si=-7fyDlDY4_IYcqBO)


